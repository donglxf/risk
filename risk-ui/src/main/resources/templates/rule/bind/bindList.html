<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>table模块快速使用</title>
<link rel="stylesheet" href="/rule/ui/plugins/layui/css/layui.css"
	media="all">
<link rel="stylesheet"
	href="/rule/ui/plugins/font-awesome/css/font-awesome.min.css"
	media="all" />
</head>
<body>


	<div class="admin-main">
		<div class="layui-row" style="margin-top: 10px;">
			<div class="layui-col-xs6">
				<form class="layui-form layui-form-pane"
					onsubmit="javascript:return false;">
					<div class="layui-form-item" style="margin-bottom: 0px;">
						<label class="layui-form-label">名称</label>


						<div class="layui-input-inline">
							<input type="text" placeholder="过滤条件查询"
								onchange="javascript:$('#btn_query').click();"
								class="layui-input" id="entityName_ser">
						</div>
						<button type="button" onclick="active.reload()" id="btn_query"
							class="layui-btn layui-btn">
							<i class="fa fa-search" aria-hidden="true"></i>
						</button>

						<!-- <button class="layui-btn layui-btn-small" id="action_btn_add">
                        <i class="layui-icon">&#xe654;</i>新增
                    </button> -->
					</div>
				</form>
				<table id="demo" lay-filter="entityTable"></table>
			</div>

			<div class="layui-col-xs6" style="display: none;" id="bind">
				<form class="layui-form" action="" lay-filter="test1">
					<input type="hidden" name="senceVersionid" id="senceVersionid">
					<input type="hidden" name="variableName" id="variableName">
					<div class="layui-form-item">
						<label class="layui-form-label">变量名称:</label>
						<div class="layui-input-inline">
							<select name="variableCode" id="variableCode" lay-filter="droolsVariable">
							</select>
						</div>
					</div>
					<div class="layui-form-item">
						<label class="layui-form-label">业务表名:</label>
						<div class="layui-input-block">
							<input type="text" id="ttt" name="bindTable" required
								lay-verify="required" placeholder="请输入业务表名" autocomplete="off"
								class="layui-input" value="TEMP_DATA_CONTAINS" >
						</div>
					</div>
					<div class="layui-form-item">
						<label class="layui-form-label">业务表字段:</label>
						<div class="layui-input-block">
							<input type="text" id="bindColumn" name="bindColumn" required
								lay-verify="required" placeholder="请输入业务表字段" autocomplete="off"
								class="layui-input">
						</div>
					</div>

					<div class="layui-form-item">
						<div class="layui-input-block">
							<button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
							<button type="reset" class="layui-btn layui-btn-primary">重置</button>
						</div>
					</div>
				</form>
			</div>


		</div>
	</div>



	<script src="/rule/ui/plugins/layui/layui.js"></script>

	<script src="/rule/ui/src/js/rule/bind/rule_bind.js"></script>
	<script type="text/html" id="sceneTypeConvert">
	{{#  if(d.type == 1){ }}
		<div>决策</div>
	{{# } else if(d.type == 2){ }}
		<div>模型</div>
	{{# } }}
</script>
	<script type="text/html" id="statusConvert">
	{{#  if(d.status == 1){ }}
		<div>正常</div>
	{{# } else if(d.status == 2){ }}
		<div>禁用</div>
	{{# } }}
</script>


	<script type="text/html" id="checkboxTpl">
    <!-- 这里的 checked 的状态只是演示 -->
    <input type="checkbox" name="isEffect" value="{{d.isEffect}}" title="锁定" lay-filter="lockDemo" {{ d.isEffect == 0 ? 'checked' : '' }}>
</script>
	<!--操作-->
	<script type="text/html" id="bar">
    <button class="layui-btn layui-btn-sm" lay-event="setItem" >
        <i class="layui-icon">绑定</i>
    </button>
</script>
	<!--操作-->
	<script type="text/html" id="item_bar">
    <button class="layui-btn layui-btn-sm" lay-event="edit2" >
        <i class="layui-icon">&#xe642;</i>
    </button>
    <button class="layui-btn layui-btn-sm" lay-event="del2">
        <i class="layui-icon">&#xe640;</i>
    </button>

</script>
<script>
    //Demo
    layui.use('form', function(){
        var form = layui.form;
        var app = layui.app,
            layerTips = layui.layer,
            $ = layui.jquery;
        
        form.on('select(droolsVariable)', function(data){
        	var ht=$('.layui-form-select .layui-this').last().html();
        	$("#variableName").val(ht);
        	$("#bindColumn").val(data.value);
        	console.log(ht);
        	  //console.log(data); //得到select原始DOM对象
        	  //console.log(data.elem); //得到select原始DOM对象
        	  //console.log(data.value); //得到被选中的值
        	  //console.log(data.othis); //得到美化后的DOM对象
        	});
        
        //监听提交
        form.on('submit(formDemo)', function(data){
           $.ajax({
                cache : true,
                type : "POST",
                url : '/rule/service/variableBind/edit',
                data : data.field,// 你的formid
                async : false,
                error : function(request) {
                    alert("Connection error");
                },
                success : function(da) {
                    if (da.code == 0) {
                        layer.msg('保存数据成功');
                        //这里以搜索为例
                      //  var index = parent.layer.getFrameIndex(window.name); // 获取窗口索引
                      // layer.closeAll();
                       active.reload();
                    } else {
                       layer.msg(data.msg);
                    }
                }
            });
            return false;
        });
        form.render();
    });
</script>
</body>
</html>